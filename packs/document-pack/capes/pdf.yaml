# PDF Cape - PDF 文档处理
# 源自 Anthropic Claude Skills: document-skills/pdf

id: pdf
name: PDF 文档处理
version: "1.0.0"
description: >
  综合性 PDF 操作工具包，支持提取文本和表格、创建新 PDF、
  合并/拆分文档以及处理表单。适用于填写 PDF 表单或
  大规模程序化处理、生成或分析 PDF 文档。

metadata:
  author: Anthropic
  license: Proprietary
  source: skill
  source_ref: anthropics/skills/document-skills/pdf
  tags:
    - pdf
    - document
    - form
    - extract
    - merge
    - split
  intents:
    - 读取PDF
    - 合并PDF
    - 拆分PDF
    - 填写表单
    - 提取表格
    - 提取文本
    - 添加水印
  examples:
    - "合并多个PDF文件"
    - "从PDF中提取表格数据"
    - "填写这个PDF表单"
    - "拆分PDF的页面"

interface:
  input_schema:
    type: object
    properties:
      task:
        type: string
        description: PDF处理任务描述
      file_paths:
        type: array
        items:
          type: string
        description: 输入文件路径列表
      output_path:
        type: string
        description: 输出文件路径
      form_data:
        type: object
        description: 表单填写数据
      pages:
        type: string
        description: 页码范围（如 "1-5,8,10-12"）
    required:
      - task
  output_schema:
    type: object
    properties:
      result:
        type: string
        description: 处理结果
      output_file:
        type: string
        description: 输出文件路径
      extracted_text:
        type: string
        description: 提取的文本
      extracted_tables:
        type: array
        description: 提取的表格数据

execution:
  type: hybrid
  timeout_seconds: 120
  tools_allowed:
    - file_read
    - file_write
    - code_execute
    - bash

model_adapters:
  claude:
    model_hint: claude-3-5-sonnet
    system_prompt: |
      你是 PDF 文档处理专家。

      ## Python 库

      ### pypdf - 基础操作

      #### 合并 PDF
      ```python
      from pypdf import PdfWriter, PdfReader

      writer = PdfWriter()
      for pdf_file in ["doc1.pdf", "doc2.pdf"]:
          reader = PdfReader(pdf_file)
          for page in reader.pages:
              writer.add_page(page)

      with open("merged.pdf", "wb") as output:
          writer.write(output)
      ```

      #### 拆分 PDF
      ```python
      reader = PdfReader("input.pdf")
      for i, page in enumerate(reader.pages):
          writer = PdfWriter()
          writer.add_page(page)
          with open(f"page_{i+1}.pdf", "wb") as output:
              writer.write(output)
      ```

      ### pdfplumber - 文本和表格提取

      #### 提取文本
      ```python
      import pdfplumber

      with pdfplumber.open("document.pdf") as pdf:
          for page in pdf.pages:
              text = page.extract_text()
              print(text)
      ```

      #### 提取表格
      ```python
      with pdfplumber.open("document.pdf") as pdf:
          for page in pdf.pages:
              tables = page.extract_tables()
              for table in tables:
                  for row in table:
                      print(row)
      ```

      ### reportlab - 创建 PDF

      ```python
      from reportlab.lib.pagesizes import letter
      from reportlab.pdfgen import canvas

      c = canvas.Canvas("hello.pdf", pagesize=letter)
      width, height = letter
      c.drawString(100, height - 100, "Hello World!")
      c.save()
      ```

      ## 命令行工具

      ### pdftotext
      ```bash
      pdftotext input.pdf output.txt
      pdftotext -layout input.pdf output.txt  # 保留布局
      ```

      ### qpdf
      ```bash
      qpdf --empty --pages file1.pdf file2.pdf -- merged.pdf  # 合并
      qpdf input.pdf --pages . 1-5 -- pages1-5.pdf  # 拆分
      ```

      ## 快速参考

      | 任务 | 最佳工具 |
      |------|----------|
      | 合并 PDF | pypdf |
      | 拆分 PDF | pypdf |
      | 提取文本 | pdfplumber |
      | 提取表格 | pdfplumber |
      | 创建 PDF | reportlab |
      | 填写表单 | pypdf 或 pdf-lib |
      | OCR 扫描件 | pytesseract |

      ## 填写表单
      如需填写 PDF 表单，请参考 forms.md 的说明。

  openai:
    model_hint: gpt-4o
    system_prompt: |
      You are a PDF document expert.

      Key tools:
      - pypdf: Merge, split, rotate, metadata, encryption
      - pdfplumber: Text and table extraction
      - reportlab: Create new PDFs
      - qpdf/pdftk: Command-line operations

      For form filling, use pypdf or pdf-lib (JavaScript).

  generic:
    prompt_template: |
      请帮我处理 PDF 文档任务：
      {task}

      输入文件：{file_paths}
      输出到：{output_path}
      页码范围：{pages}
      表单数据：{form_data}

      请选择合适的工具（pypdf/pdfplumber/reportlab）完成任务。

code_adapter:
  scripts:
    - scripts/fill_fillable_fields.py
    - scripts/convert_pdf_to_images.py
    - scripts/extract_form_field_info.py
    - scripts/check_bounding_boxes.py
    - scripts/create_validation_image.py
    - scripts/fill_pdf_form_with_annotations.py
    - scripts/check_fillable_fields.py
  dependencies:
    - pypdf
    - pdfplumber
    - reportlab
    - pillow
    - pdf2image
  runtime: python

safety:
  risk_level: medium
  audit_log: true
  allowed_operations:
    - read
    - write
    - execute
